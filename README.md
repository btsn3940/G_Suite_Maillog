# G_Suite_Maillog
G Suite (Basic Plan) にてメールログを自動収集するスクリプトです。

# 動作環境（確認済）
- Windows 10 Pro 1903
- Google Chrome
- Python 3.7
- Selenium
  - pip install selenium でインストールして下さい
- ChromeDriver
  - Google Chrome に合わせたバージョンで導入して下さい

# 配置方法
- cloneした mail_log と mail_send をローカルの任意のパスに配置して下さい
  - ここでは「c:\task」に配置したものと仮定します
  
# 利用方法
- ソースの中身の幾らかは仮のもので埋めているので自環境に合わせて修正して下さい
  - 時間はとりあえず私の環境上で合わせているので適宜変更して下さい
- ソース修正後はWindowsの タスク スケジューラ を利用してタスク設定を行います
  - 「メール取得」・「メール確認」・「メール移動」で各時間のスパン分作成、少々手間ですがご了承下さい。
  - 【全般】共通「ユーザーがログオンしているかどうかに～～」「最上位の特権で実行する」
  - 【条件】共通「コンピュータを AC 電源～～」のチェックは外してしまう
  - （以下の例は私の環境での場合です。自環境に合わせて修正下さい！）
    - メール取得
      - 【トリガー】毎日 10:05 に起動（他 16:05 / 2:05）
      - 【操作】プログラムの開始、「C:\task\mail_log\maillog_get_kick.bat」、引数 1
        - ソースに合わせて他の時間帯を 引数 2、引数 3 と設定する。
    - メール確認
      - 【トリガー】毎日 10:20 に起動（他 16:20 / 2:20）
      - 【操作】プログラムの開始、「C:\task\mail_send\send_mail.py」
    - メール移動
      - 【トリガー】毎日 10:35 に起動（他 16:35 / 2:35）
      - 【操作】プログラムの開始、「C:\task\mail_log\maillog_move.bat」、引数 1
        - ソースに合わせて他の時間帯を 引数 2、引数 3 と設定する。

# 注意点
- メールログ検索の仕様上、1000件上限のようなので時間のスパンは上限にかからぬよう適宜修正下さい。
